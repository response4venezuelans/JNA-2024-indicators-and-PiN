
```{r setup, fig.height=3, fig.width=7.5, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	collapse = FALSE,
	comment = NA,
	prompt = FALSE,
	results = "asis")

```

```{r cars2, include=FALSE}

library(tidyverse)
library(ggalluvial)
library(scales)
library(glue)
library(here)
library(sf)
library(summarytools)
library(leaflet)
library(gtsummary)
library(cowplot)
library(data.table)
library(ggplot2)
library(writexl)
library(haven)
library(tidyverse)
library(readxl)
library(srvyr)
library(robotoolbox)
library(labelled)
library(remotes)
library(dm)
library(janitor)
library(visdat)
library(dplyr)

kobo_setup(url = "https://kobo.unhcr.org/", token = "XXX)


###Run the script below to see list of your surveys
asset_list <- kobo_asset_list()
asset_list

##Find the survey you want to analyse and enter the name as below

uid <- filter(asset_list, name == "XXX") |> ## change the survey name accordingly as shown in KoBo
  pull(uid)

###You will see the number of submissions and name.

asset <- kobo_asset(uid)
asset

###Your data frame will be displayed here without the need for you to download it from KoBo
df <- kobo_data(asset)

main <- pull_tbl(df, main, keyed = TRUE) %>%
  filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country"
  )
ind <- pull_tbl(df, household_members, keyed = TRUE)

main_merged <- left_join(ind, main, by = c("_parent_index"="_index")) %>%
  rename(id_hogar = "_parent_index")%>%
  rename(id_individual = "_index")%>%
  filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country") %>%
  mutate(    
    FS_D1_Q1 = as.numeric(as.character(FS_D1_Q1)),
    FS_D1_Q2 = as.numeric(as.character(FS_D1_Q2)),
    FS_D1_Q3 = as.numeric(as.character(FS_D1_Q3)),
    FS_D1_Q4 = as.numeric(as.character(FS_D1_Q4)),
    FS_D1_Q5 = as.numeric(as.character(FS_D1_Q5)),
    FS_D1_Q8 = as.numeric(as.character(FS_D1_Q8)),
    FS_D1_Q9 = as.numeric(as.character(FS_D1_Q9)),
    FS_D1_Q10 = as.numeric(as.character(FS_D1_Q10)),
    FS_D2_Q1 = as.numeric(as.character(FS_D2_Q1)),
    FS_D2_Q2 = as.numeric(as.character(FS_D2_Q2)),
    FS_D2_Q3 = as.numeric(as.character(FS_D2_Q3)),
    FS_D2_Q4 = as.numeric(as.character(FS_D2_Q4)),
    FS_D2_Q5 = as.numeric(as.character(FS_D1_Q5))
  )


```

#database with responses of individuals from the household = ind
#database with responses of the head of household = main

#Costa Rica - in destination
#Education

```{r edu_d1_q1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
   filter(age1 >= 5 & age1 <= 17)%>% 
  count(EDU_D1_Q1=="no") %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Education
```{r edu_d2_q1_q2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
    filter(age1 <= 3) %>%
  count(EDU_D2=EDU_D1_Q1 == "no" & EDU_D2_Q2 != "in_hh_parents")%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

```{r edu_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
    filter(age1 >= 4 & age1 <=15) %>%
  count(EDU_D1_Q1=="yes" & EDU_D3_Q1 < 5)%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Child Protection

```{r cp_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count((
      CP_D1_Q1 == "family_separation" |
      CP_D1_Q1 == "discrimination" |  
      CP_D1_Q1 == "disrespectful_requests" |  
      CP_D1_Q1 == "physical_psicological_violence" |  
      CP_D1_Q1 == "sex_for_services_goods" |
      CP_D1_Q1 == "child_labor" | 
      CP_D1_Q1 == "dont_know" | 
      CP_D1_Q1 == "prefer_not_answer") &
      CP_D1_Q2 == "no")%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Food Security

```{r fs_cari, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_merged %>% 
  count(IND_FS_max)%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


```{r fs_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_merged %>% 
  count(FS_D4)%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```



#Health

```{r he_1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  count(HE_D1_Q1 == "yes" & HE_D1_Q2 == "no")%>%
  mutate(percent = n / sum(n) * 100)

freq_table


```

#Human Trafficking and Smuggling

```{r hts_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(HTS_D1_Q1 == "yes" | HTS_D1_Q2 == "yes")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r hts_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(HTS_D2_Q1 == "unpaid_longer_work" |
                        HTS_D2_Q1 == "conditioned_work" |  
                        HTS_D2_Q1 == "risky_work" |  
                        HTS_D2_Q1 == "against_will_activities" |
                        HTS_D2_Q1 == "unpleasant_treatment" | 
                        HTS_D2_Q1 == "less_paid" |
                        HTS_D2_Q1 == "no_pay" | 
                        HTS_D2_Q1 == "prefer_not_answer")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r ht_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count((HT_D1_Q1_walking == 1 |
       HT_D1_Q1_bike == 1) & HT_D1_Q2 == "30m-plus")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


#Integration

```{r ind_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age1>=15) %>% 
  count(INT_D1_Q1 == "finding_work")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r ind_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age1>=15) %>% 
  count(INT_D1_Q1 == "work" & (INT_D2_Q1 == "no"|INT_D2_Q2 == "no" | INT_D2_Q3 == "no"))%>% 
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r ind_d3_extra, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(INT_D3_Q1_nationality == 1 & INT_D3_Q2 =="work")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r ind_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count((INT_D3_Q1 =="age"|
        INT_D3_Q1 =="sex"|  
        INT_D3_Q1 =="sexual_orientation"|
        INT_D3_Q1 =="gender_identity"|
        INT_D3_Q1 =="ethnics"|
        INT_D3_Q1 =="disability"|  
        INT_D3_Q1 =="nationality"|
        INT_D3_Q1 =="other") & INT_D3_Q2 =="work")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r ind_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(INT_D4_Q1 =="none")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

#Nutrition

```{r nut_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(MH_4=="women" & age1>14)%>%
  count((NUT_D1_Q1 == "pregnant" | NUT_D1_Q1 == "breastfeeding") &
        (NUT_D1_Q2_nutritional_evaluation == 0 |
           NUT_D1_Q2_nutritional_counceling == 0 |
           NUT_D1_Q2_nutritional_counceling == 0))%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r nut_d10, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
 filter(age2 >= 24 & age2 < 59) %>%
  mutate(total = rowSums(select(., NUT_D10_Q1_breastmilk,
                                     NUT_D10_Q1_grains_roots,
                                     NUT_D10_Q1_legumes,
                                     NUT_D10_Q1_lacteo_products,
                                     NUT_D10_Q1_animal_protein,
                                     NUT_D10_Q1_eggs,
                                     NUT_D10_Q1_dark_leaf_vegetables,
                                     NUT_D10_Q1_other_vegetables,
                                     NUT_D10_Q1_other_fruits))) %>%
  count(total < 5)%>%
  mutate(percent = n / sum(n) * 100)
freq_table
```


```{r nut_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age2 <6)%>%
 count(NUT_D4_Q1_nutritional_evaluation == 0 |
        (NUT_D4_Q1_lactation_counseling == 0 | NUT_D4_Q1_non_lactation_counseling == 0))%>%
  mutate(percent = n / sum(n) * 100)
freq_table
```

```{r nut_d5, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age2 <6)%>%
 count(NUT_D5_Q1 == "no")%>%
  mutate(percent = n / sum(n) * 100)
freq_table
```


```{r nut_d8, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
 filter(age2 >= 24 & age2 < 59) %>%
  mutate(condition = NUT_D8_Q1_nutritional_assessment_weight_height_arm_measurement == 0 |
                    (NUT_D8_Q1_counseling_support_breastfeeding_evaluation_positions_difficulties == 0 &
                     NUT_D8_Q1_counseling_support_non_breastfed_babies_formula_preparation_use_cleaning_feeding_utensils == 0) |
                    NUT_D8_Q1_counseling_trained_personnel_feeding_solid_foods_diversity_preparation_feeding_children == 0 |
                    NUT_D8_Q1_delivery_vitamin_mineral_supplements_iron_vitamin_a_powder_drops_syrups == 0) %>%
  count(condition)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```


#GBV

```{r gbv_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
 count(GBV_D1_Q1 == "yes")%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r gbv_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  count(condition = GBV_D3_Q1 %in% c(4, 5)) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


#Protection

```{r pro_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  mutate(condition = case_when(
    PROT_D1_Q1 != "none" ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r pro_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
 count(PROT_D2_Q1 != "none")%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r pro_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
 count(PROT_D3_Q1 == "yes" & PROT_D3_Q3 == "no")%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```


```{r pro_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(MH_3=="N-VE")%>% 
 count(MH_6_no_valid_document == 1)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r pro_d5, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  mutate(condition = case_when(
    (PROT_D5_Q1 == "yes" | PROT_D5_Q1 == "prefer_not_answer") &
    (PROT_D5_Q2_extortion == 1 |
     PROT_D5_Q2_general_violence == 1 |
     PROT_D5_Q2_afraid_armed_group == 1 |
     PROT_D5_Q2_health_risk == 1 |
     PROT_D5_Q2_insecurity == 1 |
     PROT_D5_Q2_persecuted_assaulted_discrim == 1) ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

#Shelter

```{r she_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  mutate(SHE_D1 = case_when(
      SHE_D1_Q1 == "street" |
      SHE_D1_Q1 == "shared_house" |
      SHE_D1_Q1 == "foster_family" |
      SHE_D1_Q1 == "rooming_house" |
      SHE_D1_Q1 == "hotel" |
      SHE_D1_Q1 == "shelters" |
      SHE_D1_Q1 == "colective" |
      SHE_D1_Q1 == "spontaneous" |
      SHE_D1_Q1 == "prefer_not_answer" |
      SHE_D1_Q2_house_unprotected_insecure == 1 |
      SHE_D1_Q2_neighboor_unprotected_insecure == 1 |
      SHE_D1_Q2_privacy == 1 |
      SHE_D1_Q2_natural_disasters == 1 |
      SHE_D1_Q2_wash_issues == 1 |
      SHE_D1_Q3_sewerage == 1 |
      SHE_D1_Q3_garbage_collection == 1 |
      SHE_D1_Q3_electricity == 1 |
      SHE_D1_Q3_acueduct == 1 ~ TRUE,
      TRUE ~ FALSE
    )) %>%
  count(SHE_D1)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r she_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
    filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%  filter(SHE_D1_Q1 != "street") %>%
  
  mutate(condition = (MH_1 / SHE_D2_Q1 > 3)) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r she_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country")),
         SHE_D1_Q1 != "street") %>%
  mutate(condition = case_when(
    SHE_D3_Q1_none == 0 ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r she_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country")),
         SHE_D1_Q1 != "street") %>%

  mutate(condition = SHE_D4_Q1 %in% c("some_eviction_risk", "evicted", "prefer_not_answer")) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

#WASH

```{r wa_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
   filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country")))%>%
  mutate(condition = (WASH_D1_Q1 %in% c("rain_water", "bottled_water", "water_supply", "water_kiosk", "unprotected_well_spring", "no_pump_well", "surface_water", "none") &
                      WASH_D1_Q2 == "30min_high")) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r wa_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = (WASH_D2_Q1 == "not_enough_water" |
                      !(WASH_D2_Q1 %in% c("drink", "cook", "hygiene", "other"))) &
                     (WASH_D2_Q2 %in% c("less_3days_week", "3days_week", "more3days_week", "restricted_schedule", "dont_know", "prefer_not_answer"))) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r wa_d4 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D4_Q1 %in% c("improvised_latrine", "hanging_latrine", "no_sanitation_service_free_access", "no_sanitation_service_pay_access", "open_defecation") |
    WASH_D4_Q2 == "yes" ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r wa_d6 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D6_Q1 %in% c("river_stream", "patio_lot", "burnt", "dont_know") ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r wa_d8 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D8_Q1 %in% c("water", "soap", "cant_handwash", "antibacterial_gel") ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r wa_d8 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D11_Q1 %in% c("no", "panty_liners", "cloth_fabric", 
                       "toilet_paper", "underwear_layers", 
                       "not_applicable", "other") ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```



#Costa Rica in transit

#Education

```{r edu_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Venezuela")%>%
  count(EDU_T_Q1=="none") %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


#Child Protection

```{r cp_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
   filter(R4V_transit_pop=="Other nationality")%>%
     count(B12_children_separated == "yes")%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


```{r cp_t1_2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
  rename(F08_Mainneeds_6months_17years_psych='F08_Mainneeds_6months-17years_psych')%>% 
  rename(F08_Mainneeds_6months_17years_safe_spaces='F08_Mainneeds_6months-17years_safe_spaces')%>% 
   filter(R4V_transit_pop=="Other nationality")%>%
     count(F08_Mainneeds_6months_17years_psych == 1 |
          F08_Mainneeds_6months_17years_safe_spaces==1)%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Food Security

```{r fs_t1_1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Other nationality")%>%
  count( F03_Nmeals == "none"| F03_Nmeals == "one" )%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

```{r fs_t1_2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Venezuela")%>%
  count(F04_Food_Sec != "no_difficulties")%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Health

```{r he_t, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Other nationality") %>%
  mutate(condition = HE_T_Q1 == "yes" & HE_T_Q2 == "no") %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table


```

#Human Trafficking and Smuggling

```{r hts_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Other nationality")%>%
  count(E02_incidents_abductionORkidnapping == 1 | 
    E02_incidents_arrestORdetention == 1 |
    E02_incidents_fraud == 1)%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r hts_t2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Other nationality")%>%
  count(E02_incidents_Exploitationwork == 1)%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r hts_t3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Other nationality")%>%
  count(E02_incidents_threat == 1 |
    E02_incidents_physicalAssault == 1 |
    E02_incidents_abductionORkidnapping == 1 |
    E02_incidents_extorsion == 1)%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```




#Integration

```{r ind_t, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Venezuela")%>%
  count(INT_T_Q1 == "none" | INT_T_Q1 == "charity" | INT_T_Q1 == "humanitarian_assistance")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```



#Nutrition

```{r nut_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>%
  filter(R4V_transit_pop == "Other nationality") %>%
  count(B13_pregnant == "yes" | (B14_lactating == "yes" & H02_breastfed_problems == "yes")) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r nut_t2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>%
  filter(R4V_transit_pop == "Other nationality") %>%
  mutate(
    NUT_T10_24_59 = ifelse(
      (I01_foodpoverty_leche_materna +
       I01_foodpoverty_granos_raices +
       I01_foodpoverty_legumbres_frijoles +
       I01_foodpoverty_lacteos +
       I01_foodpoverty_carnes_pescado +
       I01_foodpoverty_huevo +
       I01_foodpoverty_verduras +
       I01_foodpoverty_otras_verduras) < 5, TRUE, FALSE
    ),
    NUT_T10_6_23 = ifelse(
      (II01_foodpoverty_leche_materna +
       II01_foodpoverty_granos_raices +
       II01_foodpoverty_legumbres_frijoles +
       II01_foodpoverty_lacteos +
       II01_foodpoverty_carnes_pescado +
       II01_foodpoverty_huevo +
       II01_foodpoverty_verduras +
       II01_foodpoverty_otras_verduras) < 5, TRUE, FALSE
    )
  ) %>%
  count(NUT_T10_24_59, NUT_T10_6_23) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r nut_t3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Other nationality") %>%
  mutate(NUT_T4=H03_humanitarian_services_weight_check == 0 |
    H03_humanitarian_services_nutrition_counseling == 0 |
    H03_humanitarian_services_health_counseling == 0 |
    H03_humanitarian_services_breastfeed_counseling == 0 |
    H03_humanitarian_services_none == 1) %>%
  count(NUT_T4) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r nut_t4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
    filter(R4V_transit_pop=="Venezuela")%>%
  count( H01_breastfed == "yes" & 
      H02_breastfed_exclusively == "none_excl")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r nut_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>%
  filter(R4V_transit_pop == "Other nationality") %>%
  mutate(
    NUT_T8_6_23 = 
      II03_humanitarian_services_parent_counseling == 0 &
      II03_humanitarian_services_supplement == 0 &
      II03_humanitarian_services_weight_check == 0 &
      II03_humanitarian_services_nutrition_counseling == 0,
    NUT_T8_24_59 = 
      I03_humanitarian_services_weight_check3 == 0 &
      I03_humanitarian_services_nutrition_counseling3 == 0 &
      I03_humanitarian_services_supplement3 == 0
  ) %>%
  count(NUT_T8_6_23, NUT_T8_24_59) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```



```{r nut_t8, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}


freq_table <- ind %>% 
 filter(age2 >= 24 & age2 < 59) %>%
  mutate(condition = NUT_D8_Q1_nutritional_assessment_weight_height_arm_measurement == 0 |
                    (NUT_D8_Q1_counseling_support_breastfeeding_evaluation_positions_difficulties == 0 &
                     NUT_D8_Q1_counseling_support_non_breastfed_babies_formula_preparation_use_cleaning_feeding_utensils == 0) |
                    NUT_D8_Q1_counseling_trained_personnel_feeding_solid_foods_diversity_preparation_feeding_children == 0 |
                    NUT_D8_Q1_delivery_vitamin_mineral_supplements_iron_vitamin_a_powder_drops_syrups == 0) %>%
  count(condition)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```


#GBV

```{r gbv_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <-main_mmm %>% 
    filter(R4V_transit_pop=="Other nationality")%>%
 count(G01_Spec_needs_woman_at_risk == 1 |
    G01_Spec_needs_victimsurvivor == 1)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```



#Protection

```{r pro_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <-main_mmm %>% 
    filter(R4V_transit_pop=="Other nationality")%>%
 count(E02_incidents != "none")%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```


```{r pro_t2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <-main_mmm %>% 
    filter(R4V_transit_pop=="Other nationality")%>%
 count(F06_Mainneeds_information == 1)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```



```{r pro_t3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>%
  filter(R4V_transit_pop == "Other nationality") %>%
  count(E07_risk_return == "yes" & 
        (E04_reasons_not_return_discrimination == 1 |
         E04_reasons_not_return_pol_instability == 1)) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


#Shelter

```{r she_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Other nationality") %>%
  count(SHE_T_Q1 %in% c("street_squat", "daily_payment", "shelter_temporary", 
                        "colective_center", "informal_setting", "transport", 
                        "dont_know", "prefer_not_answer")) %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


```{r she_t2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}


freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Other nationality") %>%
  count(SHE_T_Q2 != "none") %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


#WASH

```{r wa_t1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Other nationality") %>%
  count(WASH_T_Q1 != "yes") %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r wa_t2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}


freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Venezuela") %>%
  count(WASH_T_Q3 != "establishment_unpaid" & WASH_T_Q3 != "shelter") %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


```{r wa_t3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}


freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Other nationality") %>%
  count(WASH_T_Q4 != "shelter") %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


```{r wa_t4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}


freq_table <- main_mmm %>% 
  filter(R4V_transit_pop == "Venezuela") %>%
  count(WASH_T_Q5 %in% c("no", "pads", "cloth", "toilet_paper", "not_applicable", "other")) %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```



##Panama

#Education

```{r edu_d1_q1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
   filter(age1 >= 3 & age1 <=18)%>% 
  count(EDU_D1_Q1) %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Education
```{r edu_d2_q1_q2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
    filter(age1 <= 3) %>%
  count(EDU_D2=EDU_D2_Q1 == "no" & EDU_D2_Q2 != "in_hh_parents")%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

```{r edu_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
    filter(age1 >= 4 & age1 <=15) %>%
  count(EDU_D1_Q1=="yes" & EDU_D3_Q1 < 5)%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Child Protection

```{r cp_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count((
      CP_D1_Q1 == "family_separation" |
      CP_D1_Q1 == "discrimination" |  
      CP_D1_Q1 == "disrespectful_requests" |  
      CP_D1_Q1 == "physical_psicological_violence" |  
      CP_D1_Q1 == "sex_for_services_goods" |
      CP_D1_Q1 == "child_labor" | 
      CP_D1_Q1 == "dont_know" | 
      CP_D1_Q1 == "prefer_not_answer") &
      CP_D1_Q2 == "no")%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```

#Food Security

```{r fs_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main_merged %>% 
  count(IND_FS_max)%>%
  mutate(percent = n / sum(n) * 100)

freq_table

```
write_xlsx(main, "main.xlsx")

#Health

```{r he_1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  count(HE_D1_Q1 == "yes" & HE_D1_Q2 == "no")%>%
  mutate(percent = n / sum(n) * 100)

freq_table


```

#Human Trafficking and Smuggling

```{r hts_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(HTS_D1_Q1 == "yes" | HTS_D1_Q2 == "yes")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r hts_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(HTS_D2_Q1 == "unpaid_longer_work" |
                        HTS_D2_Q1 == "conditioned_work" |  
                        HTS_D2_Q1 == "risky_work" |  
                        HTS_D2_Q1 == "against_will_activities" |
                        HTS_D2_Q1 == "unpleasant_treatment" | 
                        HTS_D2_Q1 == "less_paid" |
                        HTS_D2_Q1 == "no_pay" | 
                        HTS_D2_Q1 == "prefer_not_answer")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r ht_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count((HT_D1_Q1_walking == 1 |
       HT_D1_Q1_bike == 1) & HT_D1_Q2 == "30m-plus")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


#Integration

```{r ind_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age1>=15) %>% 
  count(INT_D1_Q1 == "finding_work")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r ind_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age1>=15) %>% 
  count(INT_D1_Q1 == "work" & (INT_D2_Q1 == "no"|INT_D2_Q2 == "no" | INT_D2_Q3 == "no"))%>% 
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r ind_d3_extra, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(INT_D3_Q1_nationality == 1 & INT_D3_Q2 =="work")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r ind_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count((INT_D3_Q1 =="age"|
        INT_D3_Q1 =="sex"|  
        INT_D3_Q1 =="sexual_orientation"|
        INT_D3_Q1 =="gender_identity"|
        INT_D3_Q1 =="ethnics"|
        INT_D3_Q1 =="disability"|  
        INT_D3_Q1 =="nationality"|
        INT_D3_Q1 =="other") & INT_D3_Q2 =="work")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r ind_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
  count(INT_D4_Q1 =="none")%>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

#Nutrition

```{r nut_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(MH_4 == "women" & age1 > 14 & (NUT_D1_Q1 == "pregnant" | NUT_D1_Q1 == "breastfeeding")) %>%
  count(NUT_D1_Q2_nutritional_evaluation == 0 |
                NUT_D1_Q2_nutritional_counceling == 0 |
                NUT_D1_Q2_micronutrient_delivery == 0) %>%
  mutate(percent = n / sum(n) * 100)

freq_table

```


```{r nut_d10, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
 filter(age2 >= 24 & age2 < 59) %>%
  mutate(total = rowSums(select(., NUT_D10_Q1_breastmilk,
                                     NUT_D10_Q1_grains_roots,
                                     NUT_D10_Q1_legumes,
                                     NUT_D10_Q1_lacteo_products,
                                     NUT_D10_Q1_animal_protein,
                                     NUT_D10_Q1_eggs,
                                     NUT_D10_Q1_dark_leaf_vegetables,
                                     NUT_D10_Q1_other_vegetables,
                                     NUT_D10_Q1_other_fruits))) %>%
  count(total < 5)%>%
  mutate(percent = n / sum(n) * 100)
freq_table
```


```{r nut_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age2 <6)%>%
 count(NUT_D4_Q1_nutritional_evaluation == 0 |
        (NUT_D4_Q1_lactation_counseling == 0 | NUT_D4_Q1_non_lactation_counseling == 0))%>%
  mutate(percent = n / sum(n) * 100)
freq_table
```

```{r nut_d5, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(age2 <6)%>%
 count(NUT_D5_Q1 == "no")%>%
  mutate(percent = n / sum(n) * 100)
freq_table
```


```{r nut_d8, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
 filter(age2 >= 24 & age2 < 59) %>%
  mutate(condition = NUT_D8_Q1_nutritional_assessment_weight_height_arm_measurement == 0 |
                    (NUT_D8_Q1_counseling_support_breastfeeding_evaluation_positions_difficulties == 0 &
                     NUT_D8_Q1_counseling_support_non_breastfed_babies_formula_preparation_use_cleaning_feeding_utensils == 0) |
                    NUT_D8_Q1_counseling_trained_personnel_feeding_solid_foods_diversity_preparation_feeding_children == 0 |
                    NUT_D8_Q1_delivery_vitamin_mineral_supplements_iron_vitamin_a_powder_drops_syrups == 0) %>%
  count(condition)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```


#GBV

```{r gbv_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(# eligibility criterias for survey
    DEMO_00.6 != "no",
    DEMO_5 != "no",
    DEMO_7 != "return_venezuela",
    DEMO_7 != "move_different_country")%>% 
 count(GBV_D1_Q1 == "yes")%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r gbv_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  count(condition = GBV_D3_Q1 %in% c(4, 5)) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


#Protection

```{r pro_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  mutate(condition = case_when(
    PROT_D1_Q1 != "none" ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r pro_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
 count(PROT_D2_Q1 != "none")%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r pro_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
 count(PROT_D3_Q1 == "yes" & PROT_D3_Q3 == "no")%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```


```{r pro_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- ind %>% 
  filter(MH_3=="N-VE")%>% 
 count(MH_6_no_valid_document == 1)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r pro_d5, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  mutate(condition = case_when(
    (PROT_D5_Q1 == "yes" | PROT_D5_Q1 == "prefer_not_answer") &
    (PROT_D5_Q2_extortion == 1 |
     PROT_D5_Q2_general_violence == 1 |
     PROT_D5_Q2_afraid_armed_group == 1 |
     PROT_D5_Q2_health_risk == 1 |
     PROT_D5_Q2_insecurity == 1 |
     PROT_D5_Q2_persecuted_assaulted_discrim == 1) ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

#Shelter

```{r she_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>% 
    filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%
  mutate(SHE_D1 = case_when(
      SHE_D1_Q1 == "street" |
      SHE_D1_Q1 == "shared_house" |
      SHE_D1_Q1 == "foster_family" |
      SHE_D1_Q1 == "rooming_house" |
      SHE_D1_Q1 == "hotel" |
      SHE_D1_Q1 == "shelters" |
      SHE_D1_Q1 == "colective" |
      SHE_D1_Q1 == "spontaneous" |
      SHE_D1_Q1 == "prefer_not_answer" |
      SHE_D1_Q2_house_unprotected_insecure == 1 |
      SHE_D1_Q2_neighboor_unprotected_insecure == 1 |
      SHE_D1_Q2_privacy == 1 |
      SHE_D1_Q2_natural_disasters == 1 |
      SHE_D1_Q2_wash_issues == 1 |
      SHE_D1_Q3_sewerage == 1 |
      SHE_D1_Q3_garbage_collection == 1 |
      SHE_D1_Q3_electricity == 1 |
      SHE_D1_Q3_acueduct == 1 ~ TRUE,
      TRUE ~ FALSE
    )) %>%
  count(SHE_D1)%>%
  mutate(percent = n / sum(n) * 100)
          
freq_table
```

```{r she_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
    filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country"))) %>%  filter(SHE_D1_Q1 != "street") %>%
  
  mutate(condition = (MH_1 / SHE_D2_Q1 > 3)) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r she_d3, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country")),
         SHE_D1_Q1 != "street") %>%
  mutate(condition = case_when(
    SHE_D3_Q1_none == 0 ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r she_d4, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country")),
         SHE_D1_Q1 != "street") %>%

  mutate(condition = SHE_D4_Q1 %in% c("some_eviction_risk", "evicted", "prefer_not_answer")) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

#WASH

```{r wa_d1, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
   filter(DEMO_00.6 != "no",
         DEMO_5 != "no",
         !(DEMO_7 %in% c("return_venezuela", "move_different_country")))%>%
  mutate(condition = (WASH_D1_Q1 %in% c("rain_water", "bottled_water", "water_supply", "water_kiosk", "unprotected_well_spring", "no_pump_well", "surface_water", "none") &
                      WASH_D1_Q2 == "30min_high")) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r wa_d2, fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = (WASH_D2_Q1 == "not_enough_water" |
                      !(WASH_D2_Q1 %in% c("drink", "cook", "hygiene", "other"))) &
                     (WASH_D2_Q2 %in% c("less_3days_week", "3days_week", "more3days_week", "restricted_schedule", "dont_know", "prefer_not_answer"))) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r wa_d4 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D4_Q1 %in% c("improvised_latrine", "hanging_latrine", "no_sanitation_service_free_access", "no_sanitation_service_pay_access", "open_defecation") |
    WASH_D4_Q2 == "yes" ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r wa_d6 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D6_Q1 %in% c("river_stream", "patio_lot", "burnt", "dont_know") ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


```{r wa_d8 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D8_Q1 %in% c("water", "soap", "cant_handwash", "antibacterial_gel") ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```

```{r wa_d8 fig.height=4, fig.width=7, message=FALSE, warning=FALSE, dev='svg', out.width='1000px'}

freq_table <- main %>%
  mutate(condition = case_when(
    WASH_D11_Q1 %in% c("no", "panty_liners", "cloth_fabric", 
                       "toilet_paper", "underwear_layers", 
                       "not_applicable", "other") ~ TRUE,
    TRUE ~ FALSE  # Set all other cases to FALSE
  )) %>%
  count(condition) %>%
  mutate(percent = n / sum(n) * 100)

freq_table
```


